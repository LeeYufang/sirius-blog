<?xml version='1.0' encoding='utf-8' ?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/></head><body><h1 id="IamyourcontainerDarthSirius">&#171;I am your container&#187;, Darth Sirius</h1><p>Continuing the <a href="http://www.eclipse.org/sirius/">Sirius</a> blog <a href="http://melb.enix.org/category/sirius/">posts series</a>, today we will see a small tip : how to create artificial containers in your diagram?<br/>One of the main advantage of Sirius is that the graphical representations are independent from the metamodel&#8217;s structure. This means that you can choose to not respect the containment hierarchy of your model when you display it graphically. This is possible thanks to Sirius being based on <a href="http://www.eclipse.org/sirius/doc/specifier/general/Writing_Queries.html">queries</a>.</p><p>In the following example, we define a metamodel of a family :<br/><img border="0" src="./images/Metamodel.png"/> </p><p>To begin with, we define a <em>Flat</em> diagram, which displays all the members of the family at the same level :<br/><img border="0" src="./images/Flat_VSM.png"/></p><p>In the <em>Person</em> mapping, we use the <em>Semantic Candidates Expression</em> to provide which semantic elements must be represented. These expressions returning model elements, we call them <a href="http://www.eclipse.org/sirius/doc/specifier/general/Writing_Queries.html">queries</a>. To write these queries, there are different languages provided by default in Sirius : specialized interpreters (<code>var</code>, <code>feature</code>, <code>service</code>), Acceleo, raw OCL or Java. Here, we use the <em>feature</em> interpreter to get for a family all the persons referenced by the <code>members</code> reference. You can easily identify <em>interpreted expressions</em> by their yellow background in the Properties tab of an element.</p><p>We create a first diagram which represents the flattened Skywalker family:<br/><img border="0" src="./images/Flat.png"/></p><p>The next step is to add a level to model the <em>Family</em> as a container. We create a new <em>Family</em> diagram which contains a <em>Family</em> container mapping and a <em>Person</em> mapping as sub nodes:<br/><img border="0" src="./images/Family_VSM.png"/></p><p>The <em>Family</em> diagram is created and all the members are represented inside the Skywalker container.<br/><img border="0" src="./images/Family.png"/></p><p>Here we represent graphically the containment reference <code>members</code>. But what to do if we want to create an <em>artificial</em> container which does not exist in the metamodel as a containment reference?</p><p>Let&#8217;s see! Now imagine that we want to add a level to represent <a href="http://en.wikipedia.org/wiki/The_Force_(Star_Wars)">The Force</a> and if the person is related to the dark side or the light side. To do this we create a new <em>ForceSide</em> diagram :<br/><img border="0" src="./images/ForceSide_VSM.png"/></p><p>We add a new container to represent the <em>DarkSide</em> of the force :<br/><img border="0" src="./images/DarkSide_VSM.png"/></p><p>The dark side must be represented once for each family, the semantic candidate returns <em>var:self</em> which means the current family. As it should contain persons, it is defined as a <em>FreeForm</em> container.</p><p>We need to represent, in the Dark Side container, the persons that are from the dark side of the force. So we define a new sub node <em>Person</em> with the Semantic expression set to : <code>[self.members-&gt;select(p|p.oclAsType(Person).dark)/]</code><br/>This query returns all the members of a family and selects only the <em>Person</em> which has the attribute <code>dark</code> set to true.</p><p><img border="0" src="./images/Sith_VSM.png"/></p><p>Then we reuse the <em>Person</em> mapping to represent the person in its force side container.</p><p>Finally, we do the same for the light side of the force and create a <code>LightSide</code> container and the <code>Person</code> mapping to represent members of the family in this new container who are influenced by the ligth side : <code>[not self.members-&gt;select(p|p.oclAsType(Person).dark)/]</code><br/>A new <code>ForceSide</code> diagram is created in the Skywalker family and we discover that only Darth Vader is from the dark side of the force and that his children are driven by the light side of the force. <br/><img border="0" src="./images/ForceSide.png"/></p><p>As we saw thanks to the queries in Sirius, it is easy to create artificial containers which are not related to containment referencers in the metamodel. </p><p><em>"May the <strong>Sirius</strong> Force be with you"</em> ;)</p><p>The sample code from this example is available on github: <a href="https://github.com/mbats/sirius-blog/tree/master/artificial-container">https://github.com/mbats/sirius-blog/tree/master/artificial-container</a></p></body></html>